@model List<WebApp.Models.UserSubscriptionModel>
@{
    ViewBag.Title = "Home Page";
}

@using (Html.BeginForm("UserSubscriptions", "Account", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
	<div class="row">
		<div class="table-responsive">
			<table class="table table-striped table-hover">
				<thead>
					<tr>
						<th>Name</th>
					</tr>
				</thead>
				<tbody>
					@if (Model.Any())
					{
						foreach (var subscribedUser in Model)
						{
							@Html.Partial("~/Views/Account/_UserSubscription.cshtml", subscribedUser)
						}
					}
					else
					{
						<tr>
							<td>You are not subscribed to anyone.</td>
						</tr>
					}
				</tbody>
				<tfoot>
					<tr>
						<td>
							<a class="btn btn-success" id="add"><span class="glyphicon glyphicon-plus"></span> Add</a>
							<button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-save"></span> Save</button>
						</td>
					</tr>
				</tfoot>
			</table>
		</div>
	</div>
}

@section scripts {
	<script type="text/javascript">
	$(document).ready(function() {
		$("#table").on('click', '#add', function () {
			$.ajax({
				cache: false,
				url: '@Url.Action("AddUserSubscriptions")'
			}).done(function(html) {
				$('#table > tbody').append(html);
			});
		});

		$('#table tbody').on('click', 'a.delete', function() {
			$(this).closest('tr').remove();
		});

		$('[data-toggle="popover"]').popover();
	});
</script>
}